# Нефункциональные требования
## Общие
MNT-001 Должны быть организованы три линии поддержки: L1 - help-desk (возможно с чат-ботом), L2 - инженеры техподдержки (эксплуатация), L3 - участники команды разработки.


## Наиболее важными атрибутами качества системы признаются:
* Security (безопасность пользовательских данных)
* Usability (удобство использования)
* Fault-tolerance (отказоустойчивость)
* Reliability (надежность)
* Scalability (масштабируемость)
* Cost (стоимость)
* Domain partitioning (способность к сегментации по доменам)
* Testability (трудоемкость тестирования)
* Agility (пригодность к быстрым изменениям)

## Security
* SEC-001 Пароли пользователей должны находиться в хранилище секретов.\
* SEC-002 Запуск сервиса внутри контейнера должен быть не от привилегированного пользователя root.\
* SEC-003 Управляющие интерфейсы и консоли веб-серверов или системы хранения медиа-файлов должны быть отключены или закрыты от публичного доступа средствами ApiGateway.\
* SEC-004 Процесс веб-сервера должен запускаться от отдельного пользователя, а не от root. Этот пользователь должен быть включен в группу пользователя-владельца ресурсов.\
* SEC-005 Приложения и middleware должны экспортировать события ИБ в SIEM-систему.\
* SEC-006 Хранение персональных данных должно осуществляться в защищенном контуре отдельного сетевого сегмента.\

## Usability
## Availability
* AVL-001 Следующие подсистемы (согласно концептуальной схеме) должны быть отнесены к классу надежности Mission Critical с коэффициентом доступности не ниже 99.97 и показателями RTO/RPO - 120 мин/10 мин с допустимым количеством отказов не более 5 в год: 
* AVL-002 Следующие подсистемы (согласно концептуальной схеме) должны быть отнесены к классу надежности Business Critical с коэффициентом доступности не ниже 99.90 и показателями RTO/RPO - 120 мин/15 мин с допустимым количеством отказов не более 10 в год:
* AVL-003 Следующие подсистемы (согласно концептуальной схеме) должны быть отнесены к классу надежности Business Operational с коэффициентом доступности не ниже 99.75 и показателями RTO/RPO - 480 мин/1440 мин с допустимым количеством отказов не более 15 в год:  
* AVL-004 
* AVL-003 Система должна иметь горячий резерв

## Reliability
## Scalability
## Cost
## Domain partitioning
## Testability
## Agility
## Требования роста
* RND-001 Плановый рост пользовательской аудитории в годовой перспективе: 100%. Требуется сохранить установленный SLA на текущем уровне
* RND-002 Ожидаются единовременные краткосрочные пики пользовательской активности в период проведения промо-акций и PR-компаний по продвижению. SLA не должен нарушаться.

---------------------------------------------------------------------------------------------------

 


USE-1 Система должна показывать подсказки базовых действий по процессу оформления заказа и онлайн-оплаты. 
USE-2 Веб-интерфейс должен иметь online-чат c поддержкой
USE-3 95% новых пользователей должны суметь успешно ввести заказ без ошибок с первой попытки
USE-4 Веб-интерфейс должен отображаться штатно на устройствах c IOS версий >= 12 и Android версий >= 10

PERF-1 Система должна обслуживать порядка 500 активных пользователей одновременно 
PERF-2 Система должна бронировать выбранные позиции на складе при старте оформления заказа не более чем за 1 секунду и аннулировать бронь, если оплата не произведена в течение 10 минут с момента перехода в режим оплаты. 
PERF-3 Все веб-страницы сайта, включая страницы каталога, должны загружаться не более чем за 2 секунды после запроса их по интернет-подключению со скоростью 100 Мбит/сек.

SEC-1 Трафик между сайтом и бухгалтерской системой должен быть зашифрован с использованием ключей шифрования ГОСТ
SEC-2 Пользователи при оформлении заказа должны подтверждать согласие на использование указанных персданных
SEC-3 Сайт должен позволять клиентам просматривать только заказы, размещенные ими лично, но не другими клиентами.
SEC-4 При аутентификации пользователя должен использоваться второй фактор

REL-1 Если соединение между пользователем и сайтом разрывается до того, как заказ подтвержден или отменен, сайт должен позволять пользователю восстановить незавершенный заказ и продолжить работу
REL-2 Процессы основных компонентов сайта должны быть подключены к системе мониторинга. Которая должна направлять алерт-сообщения на почту L2 и в телеграм-канал поддержки. 



## Доступность инфраструктуры и сервисов (Availability)
AVL-1	GitLab, ArgoCD, Sonar, Nexus должны предоставляться как сервис.
AVL-2	Prometheus, Graphana, ELK должны предоставляться как сервис.
AVL-3	Доступ к сервисам должен осуществляться через Service Discovery - по имени, а не напрямую. Service Discovery должен обеспечивать балансировку и проверять liveness и rediness probe сервиса.

## Развертываемость (Deployability)
DPL-1	Для команды-владельца должны быть созданы роли: разработчик, администратор, в интерфейсе Sonar https://sonar-dev.tech.moex.com/ для управления политиками и quality gate процесса CI/CD.\
DPL-2	Команда Beta (beta@moex.com Beta@moex.com) должна иметь доступ к интерфейсу GitLab для выполнения ручного одобрения (manual approve) развертывания и установки параметров развертывания на INT и UAT контурах.\
DPL-3	Команда эксплуатации MXT должна иметь доступ к интерфейсу GitLab для выполнения ручного одобрения (manual approve) развертывания и установки параметров развертывания на QA и промышленном контуре.\
DPL-4	Обязательно указание реальных лимитов системных ресурсов, необходимых для старта и работы контейнеров.\
DPL-5	GitLab DEV должен быть единым источник правды в отношении кодовой базы. Остальные GitLab – это место хранения deploy-map для контуров INT-UAT и PROD.
FNR-1	Процесс развертывания должен быть автоматизирован средствами Gitlab.\ 
FNR-2	Исходный код должен храниться в репозитории корпоративного Gitlab: MOEX TREASURY / widgets / cmp-vue-widgets · GitLab\
FNR-3	Развертывание на стенды DEV, QA должно выполняться автоматически после одобрения (approve) (возможно двойного) MR в Master(Main) ветку и соответствующего тэгирования.\
FNR-4	Развертывание на стенды INT, UAT должно выполняться автоматически при условии ручного одобрения (manual approve) со стороны команды тестовых полигонов beta@moex.com Beta@moex.com.\
FNR-5	Развертывание на стенд PROD должно выполняться автоматически при условии ручного одобрения (manual approve) со стороны команды эксплуатации MOEX Treasury.\
FNR-6	Gitlab Pipeline должен включать стадию SCA-анализа с критериями качества, заданными корпоративным шаблоном ИБ.\
FNR-7	Gitlab Pipeline должен включать стадию SAST-анализа с критериями качества, заданными командой-разработчиком через quality gate.\
FNR-8	Gitlab Pipeline должен включать стадию инсталляции версии виджетов в корпоративный бинарный репозиторий Nexus.

## Надежность (Reliability)
REL-1	Контейнеризированное приложение должно быть развернуто в количестве реплик, отвечающим интенсивности обращений и нагрузке (минимум двух).
REL-2	Приложение должно поддерживать пробы (Liveness, Readiness and Startup Probes. Пробы должны реально проверять приложение. Не должны быть завязаны на проверку зависимых сервисов.

## Удобство использования (Usability)
UBL-1	Синтаксис файла конвейера должен быть удобным для разработчика и соответствовать современным индустриальным стандартам разработки.
UBL-2	Необходимо использовать доступные шаблоны фаз конвейера для минимизации дублирования кода и снижения трудоемкости.

## Способность публиковать свое внутреннее состояние (Observability)
OBS-1	Должен быть порт Prometheus, для мониторинга приложения и сбора метрик. (Должны отдаваться основные бизнес метрики сервиса.  Должны отдаваться метрики производительности приложения (скорость обработки, очереди и т.д.))
OBS-2	Логирование должно производиться в формате json без буферизации в стандартный вывод stdout (минимизировать кастомизацию полей, все поля должны быть строго типизированными). Формат лог-сообщений должен быть согласован с ИБ.
OBS-3	Приложение должно публиковать информацию: "/actuator/health/liveness" and "/actuator/health/readiness". Production-ready Features (spring.io)

3.8.	Прочие требования к контейнеризируемым приложениям
OTH-1	•	После инициализации приложение не должно менять своего внутреннего состояния (должно быть stateless).
OTH-2	•	По возможности должны по максимуму использоваться стандартные порты.
OTH-3	•	Для контейнеров приложений использовать легковесные базовые образы.
OTH-4	•	Применить шаблон chassis – сделать отдельный стартер для boilerplate-кода.
OTH-5	•	Приложения должны регистрироваться в реестре сервисов и регулярно подтверждать регистрацию. 


## Доступность (Availability)
AVL-1	Веб-сервер должен быть доступен в период с 09:00 до 20:00.
AVL-2	Доступ к серверам со статическими файлами виджетов должен осуществляться через реверс-прокси, на котором должны действовать правила направления трафика, основанные на метриках доступности. 


## Производительность (Performance)
PRF-1	Веб-сервер должен отвечать на запрос не более чем за 10мс. Одновременно допустимо до 200-250 запросов в период с 10:00 до 19:00.
PRF-2	Веб-сервер должен кешировать часто запрашиваемые ресурсы.
	- Включить в конфигурации NGINX кеширование

## Развертываемость (Deployability)
DPL-1	Для команды-владельца должны быть созданы роли: разработчик, администратор, в интерфейсе Sonar https://sonar-dev.tech.moex.com/ для управления политиками и quality gate процесса CI/CD.
DPL-2	Команда Beta (beta@moex.com Beta@moex.com) должна иметь доступ к интерфейсу Gitlab для выполнения ручного одобрения (manual approve) развертывания и установки параметров развертывания на INT и UAT контурах.
DPL-3	Команда эксплуатации MXT должна иметь доступ к интерфейсу Gitlab для выполнения ручного одобрения (manual approve) развертывания и установки параметров развертывания на промышленном контуре. Позволит ускорить и централизовать процесс развертывания релиза Виджетов. Позволит исключить риск недоступности сотрудников подразделения DOP в момент развертывания на Production.
DPL-4	В ОС ВМ назначения должен быть создан пользователь-владелец ресурсов-виджетов.
	- Подать заявку на создание пользователя widgets на хостах: 
	В ОС ВМ назначения должен быть создан пользователь, под которым GitLab сможет загружать сборки виджетов в файловую систему по SSH. Аутентификация должна выполняться по ключу. Пользователь должен быть включен в группу widgets.
DPL-5	- Подать заявку в ОСА на создание пользователя gitpipe с авторизацией по ключу на хостах\ 

## Надежность (Relibility)
REL-1	Веб-сервер должен быть подключен к системе мониторинга (процесс или веб-сценарий). События мониторинга должны отправляться на почту группы эксплуатации.\
REL-2	Необходимо уйти от DROP-технологии Octopus. Позволит исключить риск, связанный с окончанием лицензии.


## Способность публиковать свое внутреннее состояние (Observability)
OBS-1	Веб-сервер должен публиковать свое состояние для подключения к системе мониторинга Zabbix

