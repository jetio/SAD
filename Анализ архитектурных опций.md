# Анализ архитектурных опций

## Выбор между in-house разработкой и vendor
В пользу in-house:
* Vendor lock
* Собственная компетенция 

В пользу vendor:
* Bus-factor
  
Решение: подсистемы класса "main" (см. функциональную архитектуру) должны разрабатываться собственными сислами, supporting-подсистемы можно отдать на outsource.

## Архитектурный стиль
Отвергается монолит из-за слабых показателей: 
agility (а бизнес-требования включают необходимость быстрых изменений), 
elasticity (для монолита будет крайне неэффективно, тк "горячей" может быть одна подсистема, а ресурсы придется выделять с учетом системы целиком),
scalability - горизонтальное масштабирование ограничено,
fault-tolerance - из-за централизации.

Отвергаются микросервисы в основном из-за сложности процессов разработки и поддержки в разноязыковых, геораспределенных командах (в частности поддерживаемость контрактов, сложность тестирования end-to-end)

Отвергается SOA, т.к. во главе угла легковесность, децентрализация и domain-partitioning.

Отвергается space-based, т.к. нет необходимости в жесткой integrity и performance

Отвергается event-driven, т.к. слабо поддерживает domain-partitioning и сложность тестирования end-to-end

Решение: целевой архитектурный стиль - Service Based, потому что хорошо приспособлен к изоляции подсистем, позволяет гибко подстраивать вычислительные ресурсы, упрощает функциональную структуру, дает возможность обеспечить высокую доступность и отказоустойчивость, умеренно пригоден для быстрых изменений. 

## Модель консистентности
* Для подсистемы продаж - strong.
* Для подсистемы инфопортала - weak.
* Для подсистемы спорт-активностей - weak.
* Для подсистемы социальных компонентов - weak.

## Распределенность данных
Т.к. пользователи будут привязываться к реплике по геолокации, реплицирование и распределенность данных являются ключевыми архитектурными принципами, закладываемыми в систему. 

## Сеть CDN
Ввиду наличия социальных компонентов и, как следствие, обмен медиа-контентом между пользователями, необходима организация CDN сети с узлами в основных точках скопления пользователей - крупных агломерациях. 

## Стратегия развертывания
Целевой стратегией является blue-green deploy (для проверки боевого UI тестировщиками, тк пользовательские интерфейсы играют основную роль в формировании положительного имиджа приложения).

## Целевой стек (исходя из изложенного выше)
* Отдавать предпочтение opensource, а не enterprise. Ставка на сообщества.
* На данном этапе можно определить только базовый технологический стек:
- CentOS
- Kubernetes
- Cassandra (для подсистемы продаж) + MongoDB (для инфопортала) + Postgres (для БД сервисов)
- GitLab + Harbor + ArgoCD
- Sonar + Dependency Track
- Java (Spring Boot) + React
- Keycloak + Kong
- Prometheus + VictoriaMetrics + Grafana + Jaeger
