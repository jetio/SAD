# <слайд 1>
Здравствуйте, коллеги.
Сегодня представляем концептуальную архитектуру решения Insportix - социально-коммерческой платформы, которая призвана помочь людям найти себя в спорте: кому-то вовлечься в спортивный и здоровый образ жизни, кому-то посоревноваться и улучшить свои достижения, а кому-то организовать деятельность в околоспортивной сфере.  
Назначение этой презентации - озвучить бизнес-цели, показать проект ИТ-решения и риски на пути его реализации. Помимо этого дать оценку стоимости владения и обрисовать планы развития. 

# <слайд 2>
Начнем с бизнес-целей, представленных на слайде - это по сути три крупные категории:
* расширение рынка сбыта,
* увеличение прибыли,
* фасилитация маркетинга
Нужно понимаьб, что все эти цели являются производными от главной цели любой коммерческой организации - выживания в конкурентной среде. Поэтому итогом презентации должно стать понимание, позволит ли баланс потенциального успеха платформы с одной стороны и стоимости и рисков с другой повысить прогноз выживаемости бизнеса.   

# <слайд 3>
Чтобы к этому прийти, мы должны отчетливо понимать, какие бизнес-домены лежат в основе тех направлений, которые мы хотим развивать посредством презентуемой платформы. 
К ним относятся:
* продажи
* клиенты
* персональные активности
* групповые активности
* цифровой профиль
* социальные компоненты
* информационный портал
Такая модель предметной области дает нам границы контекстов будущих подсистем и понимание бизнес-архитектуры в том смысле, какая подисстема в каких бизнес-процессах участвует и за какую функциональность отвечает, а также какие подразделения в каких системах работают. На слайде представлена неформальная диаграмма контекстов, которая ложится в основ как раз бизнес-архитектуры платформы. 

# <слайд 4>
Теперь рассмотрим те самые чаши весов, которые в конечном итоге должны будут ответить на вопрос о перспективах платформы.
Ключевые факторы успеха:
- **Киллер-фичи**: аналитическая подсистема - позволяет сравнивать себя с другими участниками; геймификация; спорт-профиль
- Основные каналы:** веб-приложение и мобильное приложение** - 
- **Service Based** архитектура - дает хорошие бенефиты по таким атрибутам качества как: 
пригодности к изменениям (что критически важно для современных распределенных систем с социальными элементами)
стоимость разработки и обслуживания,
трудоемкости развертывания
доменное сегментирование (ключевая характеристика, согласующаяся с бизнес архитектурой)
толерантность к отказам (что крайне важно при широкой аудитории)
пригодность к тестированию (что позволит поставлять проверенную и качественную услугу потребителю)
Также у целевого архитектурного стиля неплохие показатели по производительности, масштабированию (подспорьем чему будут облачные технологии и контейнеризация), а также простота разработки.
- **Облачные провайдеры** - дает нам гибкое управление расходами.
- **Cloud-native решение**. Что позволит переложить существенную часть инфраструктурного обеспечения на подходящих региональных провайдеров.  
- Безопасное хранение персданных - зарабатывает для нас доверие пользователей.

# <слайд 5>
## Ограничения
Как и в любом проекте в нашем тоже есть ограничения. Сейчас видим внутренние и внешние:
### Внешние
 - зависимость от локальных контрагентов, например, от банковских платформ и платежных сервисов региона (для покупок),
 - зависимость от законодательства разных стран,
 - языковые барьеры между пользователями, говорящими на разных языках,
 - часовые пояса,
 - социальные компоненты приложения должны быть функционально сравнимы с популярными соцсетями и мессенджерами, потому как в противном случае, перспективнее развивать бренд компании в них. 

### Внутренние
 - разные языки и часовые пояса команд аналитики, разработки, тестирования - осложненный менеджмент.
 - бюджет и прочие ресурсы (приложение - это дополнительный канал дистрибуции, а не основной бизнес компании).

## Риски
Здесь придется немного позанудствовать, но все же перечислю те, что видны уже на этапе проектирования.
### Бизнес
- В разных регионах требования поддержки и опернадежности разные. Риск не обеспечить заданный уровень.
- Фрагментации бизнеса. Унификация интерфейсов и БП в разных представительствах представляется неэффективной, т.к. не учитывает местных особенностей.
- Социальная активность отличается в разных регионах, и что хорошо в одном регионе может вызвать отторжение в другом. Требуется детальная проработка методики изоляции и сегментирования контента.
- Большое количество подрядчиков в разных регионах требуют сложной сети процессов и их автоматизации.
- Социальные элементы могут как поднять популярность бренда, так и сработать как анти-PR. Конкуренты могут использовать через них техники социальной инженерии для дискредитации бренда.
- Социальные элементы могут быть использованы группами лиц для противоправной деятельности
- Сложность оценки эффективности влияния на продажи социальных элементов.
### Правовые
- Риск подачи исковых заявлений в связи со сбором данных о здоровьи без документально подтвержденного согласия.
- Разное законодательство в части обработки и хранения персданных - облачные решения могут не соответствовать требованиям.
### Стратегический
- Среди конкурентов - топовые соцсети, в которых при желании можно реализовать схожую функциональность, и приложения-аналоги, например: Runtastic или - - SportMaster Media, развиваемые лидерами рынка. Риск - нехватка ресурсов для поддержки конкурентного уровня.
Большой штат разработчиков должен быть дополнен крупными подрядчиками во избежании bus-фактора при потенциальном расхождении взглядов менеджмента и ИТ.
### Технические
- Разрозненность провайдеров. Возникает трудность "сшивания" и выравнивания SLA.
- Команды эксплуатации привязаны к региону. Это порождает риски, связанные с поддержкой.
- Риски неравномерного распределения компетенций - перекос в распределении задач на разработку.
- Раскатка релизов на весь ландшафт под управлением разнородных облачных провайдеров.
- Нарушение целостности/доступности/конфиденциальности информации в результате наличия уязвимостей и недекларированных возможностей в используемых технологиях.

# <слайд 6>
Если со многими рисками нам поможет справиться менеджмент и юристы, то с техническими никто нам не поможет. Тут, как говорится: никто кроме нас!
Давайте посмотрим, как в архитектуре учитывались технические риски:
На слайде неформальная диаграмма концептуальной архитектуры
Мы уже говорили про некоторые атрибуты качества:
- (Agility) пригодность к быстрым изменениям
- (Testability) пригодность к тестированию
- (Fault Tolerance) толерантность к отказам
- (Domain partitioning) доменное сегментирование
- (Cost) трудоемкость, стоимость

Вышеозначенные риски предписывают нам дополнить этот список еще и:
* Security (безопасность пользовательских данных)
* Usability (удобство использования)
* Availability (доступность)
* Observability (наблюдаемость)
* Maintainability (сопровождаемость)

Мы будем делить нашу систему на уровни и доменные сегменты. 
Основные уровни платформы:
- уровень интерфейсов (веб и мобильный)
- уровень API-Management
- бизнес сервисы
- инфраструктура

Доменным сегментам соответствуют подсистемы.
Сопровождение подсистем ведут команды эксплуатации 

# <слайд 7>
Что же мы можем противопоставить указанным рискам?
Во-первых, требования к опернадежности

Главное здесь - компромисс: 
часть систем Mission Critical: с коэффициентом доступности не ниже 99.97 и показателями RTO/RPO - 120 мин/10 мин с допустимым количеством отказов не более 5 в год: подсистема каталога и продаж, подсистема собственных спорт-активностей, клиентская подсистема, хранилище персданных, ядро, хранилище секретов., 
часть Business Critical: с коэффициентом доступности не ниже 99.90 и показателями RTO/RPO - 120 мин/15 мин с допустимым количеством отказов не более 10 в год: цифровой профиль, подсистема коммуникаций, социальные компоненты, групповые спорт-активности, подсистема мониторинга, 
часть Business Operational с коэффициентом доступности не ниже 99.75 и показателями RTO/RPO - 480 мин/1440 мин с допустимым количеством отказов не более 15 в год: информационный портал, хранилище media-данных, подсистема аналитики и DWH.

Какими средствами достигается?
- Кластеризация
- георезервирование
- балансировка нагрузки
- DRP

# <слайд 8>
Что еще?
Требования к защите персональных данных. 
Хранение персональных данных происходит в специальном сегменте сети с повышенными требованиями безопасности: отдельный firewall; отдельный процесс согласования прав доступа; отдельное протоколирование операций доступа к данным; доступ только по SSL/TLS при предъявлении персонального сертификата УНЭП; процедура перевыпуска УНЭП (не реже одного раза в год).

# <слайд 9>
От концептуального уровня спустимся к уровню имплементации.
На слайде контейнерная диаграмма, где обозначены инфраструктурные подсистемы, бизнес-сервисы и их СУБД, подсистемы observability, системы эксплуатации.

# <слайд 10>
На каком техстеке это предлагается делать?
**Контейнеризация**: Kubernetes

**СУБД**: Cassandra + MongoDB + Postgres + Redis + Clickhouse + Pinot + MySQL

**OPS:** GitLab + Nexus + ArgoCD + Vault

**QA**: Sonar + Dependency Track

**APP**: Java (Spring Boot) + React

**API/AUTH**: Keycloak + KrakenD + NGINX

**OBSERVABILITY**: VictoriaMetrics + Grafana + ElasticSearch + Fluentd

# <слайд 11>
CI/CD
Тезисно: единственный источник правды - это gitlab
Бинарный репозитории: для docker-образов, для helm-чартов.
Синхронизировать деплоймент через ArgoCD.
Дескрипторы развертывания хранятся в репозитории deploy-map (перечень разворачиваемых приложений).

# <слайд 12>
Расчет вычислительных мощностей на старте проекта производился исходя из официальных минимальных production-ready-рекомендаций и экспертного мнения архитектора. 
Всего 72 виртуальных машины с суммарными характеристиками: 204 CPU, 516 RAM, 30304 HDD.

# <слайд 13>
Стоимость владения 
Вычислительные ресурсы планируется брать в эксклюзивную аренду у облачных провайдеров. 
Всего: 72 виртуальных машины с суммарными характеристиками: 204 CPU, 516 RAM, 30304 HDD.

Без учета ФОТ существующей команды, лицензии на ПО, и дополнительных внешних услуг:
сумма CAPEX и OPEX в первый год оценивается в 3 600 000 руб. или 300 000 руб. / мес.
OPEX во второй год (при двухкратном увеличении данных) - 4 200 000 руб.
OPEX в пятый год (при десятикратном увеличении данных) - 15 000 000 руб.

На этом я доклад завершаю. Буду рад ответить на вопросы. Спасибо!
